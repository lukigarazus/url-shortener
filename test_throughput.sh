printf "%s" "waiting for Server ..."
while ! timeout 0.2 nc -zv localhost 3000 &> /dev/null
do
    printf "%c" "."
done
printf "\n%s\n"  "Server is online"
start=$(date +%s)

REQUESTS=100

echo Testing throughput of $REQUESTS synchronous requests per second

for I in {1..$(seq $REQUESTS)}
do
    curl -X POST -H "Content-Type: application/json" \
    -d '{"url":"https://www.typescriptlang.org/play?target=1#code/MYGwhgzhAECC0G8BQBIMAuaA7ArgWwCMBTAJ2gF5oAmAblQiIBd5KAKASgoD5FUVgA9lggCQRAHQgBAc1YByBszkAaaIwAWASwjtUAX1SDhjEjmCMBJVgAccBEJuBqAntaKYIJzVmmdk+pANQSBgAIV40Dy8fCmg5ABY5OhQCTFxCUljaVGkmaFzGRlIOCJQSJhwSLGh45IMg8ChoAGFEaGA0-GIySipoBpDoABEIgBNOjJ7qZKNPU3NLGzsHJ2sJ7r9+wKRgpoBRNvdsLszeraQLxlciaD2AD1AcUaIAMRIBPAAVHGsxAB5PtAiHcilhRjBymBRkIQM5oGAsM4ANoAXVUex4lEBwNB4OgSO8ADNMgAJVTiClEzIAJRR0AA-PiSXScUQwTAkXs6Yz7o9nm8Pt9fkQ-tT0TxMEiydAKeJeSAnq93l8fv8xbcuHTJSi6Egrm5bg8FfzlUKxJ8SGBNA4fACgSC2XjIdCsLD4YjUeLYtiHez8VSyNLZQHoLSGaH7biYKxnTC4XtUZxGVKtUzyRT5YqBSrhRarTbpKLxanUbr9TcAKpYTRCT4CACSWCKJAY5hrWD+FcxqFYFcjjpgCLhjNYAGtMBXOOQeAA3ASaUbQNJEGekTisv2sMeYEP1qez+ejJPQetL7Ar0hl65wEiW5x7MR4NmMAGY6A+qPQVghvbsVHhg5ME+K8DWaRoIDrakiAgHAQBfT43w-AcvywIgAHcv1lMASGkCBMCHfdoBDalj2pM9gMua8wJCOtYBwiBX29ftN1QjDWCw+idywYkyFgQiCPDeANzxf9GRwMEiEJbwiEXTB4CAkCbmoqAzSIWj6NUu1hI5WUiBAPD3WcFE3wQfEAGkiDhbxoFHSyBEJd8UUwZSIIEOjcIBJELKMng9F1SiDQAKXnDsENiKt2zrRtm1bRh2z+FzIOg2CXzou8HyIJ8m1fLguF1QlxLbIRoAAKxCrTfTxIdUS4diKWw3CAEYgPYZc2I43CqEwTMTUFVU1Mta1vELRL+vU3DNIQ1RxOeKTUNGLhCOC7xGP8FAAHp1ugAABRgIAAWk0aQsEsIhDCETxoAEHBm0bTwEWAaDYgaiBGvEPAwGsLcH1UTRCNY24QA4dhdRQAqsCK6pqVYDRtHwxF03EF6usNPklT63NBoLBLwNU8aIP619pokuaZMW3g+E2na9sO47Tr4WZGCIrBUJIO7GAep7KBet6Pq+1gfqI-70MBurxFYZGCTpAAfaX8RRdhFdBlAClgaxfk0GSAAV3jcEgriGaDgBITRrAsFsYa0CBEe8Vn2c5nRKa2xnoGsXX2YAWU++G4UoBA-Kd9oLqZgodYEax2ezL3rFiGxdaiE2YjliBnEIURoDl9INm4UoqZQTQHLj8PPc+8R1EgAB5NCsDDvWriL6xFdzraUDKCoqld93jGjpE3fDlFA5QAxW7zl3vHuiHoIAdU0DRa9iceOcniBxCkuDikXnPF7Lyvq9r0h677xuQcHo+S+sXvdbpShF4dme591yQ2WkDRoB4RrwwEAgSqIcwz2-Ywd9Z7qFrkiAADDLOWX8f7mBPiPFu5RGCVGqGfbun1L790DsPDaW1CSWC-GIJmm97LMwno9HQzdoBg3wawQhndw7M1IYwPwg8UDQN-owDB1hr5MK4QPeBVDsFUyEVtRByCUIizDncZwrB2HmFUMgARKsmCsAAPqMFUNYRGL0WFKPzoXAAhDYRhcjmG6JwVQ1uY9jAwBvoA5eq9rTNgAZdacrtGGL10Ho-RX5F4rzED4DQ5i86t34BdUQEgpCyD8eAtErtVAV2-hw8QBQq4111gfZwhsIDG1NubFxe1YniEZvMc2milasNbokmBjBxCzWkvvfWMjTGaISUk8wKSmBpMaQbI2JszaLBiRA8p8JByIi8RY0JIjLHTNbmIjuUFCRiA6QUWR7SNHxJlPVeiEy856GUIPKmig1EbK0VspGOzKGTKpvMqGkllm1OOaHLungo6fRsOwVp5ydGHK2tMvQTdIDQGWqFLgARUDUnEH3Cw5ZYgFGaB8Ag0lRhhxhdcMW11br2PISfVAVNdoHSOidcoqBbmhm2EgcGkN8hMDVhrbWGSmnZNyQMi2HMcJMB9ojaBBlqoKwiGS554dMnMv6ebCAGLv46HEOUUYZgiBbjAMAYAqhng5IoW4xR1CyCsBdrZKy1Q1XAAoVqnxrADFIjkCUsw5s5AonEN4NGEr9WKz4FU9ZdTJINMZfXJVKqbKWVVUbCASJ9UKz4Ngslfq6iqHZQUXQBhKWFTisVIVdcsl9LyZYCVsoeU+0TAK9u1QeXvXedU5JqS94+ozTksV2aE0XCpSm6oQq0VuBzRSPNhkC2KLJSWvmrBy0rKYKigQ5YK6EgbUmiGzaaWMARYQZFo7yySpKryj0-Le1FrnXShwDLhVMszayiV-tEatrHdcDt4geWusTS7WAoRmgjEoGVbwrBYCqFCKoZoqghgnxdmAAgwBFyUABg+p9rBLVgDtcTep81YNevg-iKgCs6BU1mBEyQMgJZAdGKoQDwHOmFFIPh3D4hFCwGBhcdDwd6FtqIM0S0aEQCxAqp+f2tVoFAVUMAMAIAQAECVeOL8XHDKETnAuQiyA850OhQIWI0C0MtzQloMQX45MsJCbx-jgngCjiLhYE+IS5OxCHbU8947CQGYEEZluBhhHUedrR1W-Gek1pZeK2OomBKaqQKPWjRq60tliP7UZhklNULk+WRjYBmOsAIKoNZJUpN+Zbmai1cgzMqDiGlMAzg7UOohsaaCSXinB1KZYcQWAwBPibtJtLYTjDQCNbY6AZmiPdOraKrNFtoG6BCdqr8Lsj6MJa5phr6WG6jaPeKpugWeshqPjwlrfDUuWKHmt1u9m7P9YQdu+bx61sBzW94ZshIlU3HrJ8aCTN6tUIwMcSYEWUB4EwCUNxEnRhHbW029s74buWzhmJ3gedYYrzAFkZ7YP3qxF+0IEopkMNiCw7IMHnAA4OZo01oorjzwYWu54DgEWkeROw+1yt6SD29NrQtmGN3PlqBu+9KjuwYBa2ws+CIEO2ApaseE5HUTAc6DqBS1nLRVOLm0tAdn5Qmxc4R3wGCeskZE4CIm1gANmgS+BirkGQA"}' \
    'http://localhost:3000/api/url/add' \

done
end=$(date +%s)
if ((end - start > 1))
then
    exit 1
else
    exit 0
fi